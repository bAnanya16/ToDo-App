<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Todo App - JavaScript</title>
  <style>
    /* ---------- your original styles ---------- */
    * { box-sizing: border-box; }
    body {
      font-family: sans-serif;
      background: #f3f3f3;
      padding: 30px;
      background: linear-gradient(120deg, #6060e9 0%, rgb(148, 79, 212) 100%);
    }
    .app-title { text-align: center; margin-bottom: 20px; }

    .todo-container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
    }
    .input-section { display: flex; gap: 10px; margin-bottom: 20px; }
    .input-section input,
    .input-section select,
    .input-section button { padding: 10px; font-size: 16px; }

    .todo-list { display: flex; flex-direction: column; gap: 10px; }

    .todo-item {
      display: flex; align-items: center; gap: 10px;
      background: #f9f9f9; padding: 10px; border-radius: 5px;
    }
    .todo-text { flex: 1; }

    .todo-item.completed .todo-text { text-decoration: line-through; color: gray; }

    .priority-high { color: red; font-weight: bold; }
    .priority-medium { color: orange; }
    .priority-low { color: green; }

    .todo-checkbox { width: 24px; height: 24px; cursor: pointer; }

    .filters { margin-top: 20px; display: flex; justify-content: space-between; }
    .filters button { padding: 8px 12px; }
    .filters .active { background: #6060e9; color: #fff; }

    .stats { margin-top: 20px; font-size: 14px; }

    /* utility */
    .hidden { display: none !important; }
  </style>
</head>

<body>
  <h2 class="app-title">Todo App</h2>
  <div class="todo-container">
    <div class="input-section">
      <input type="text" id="todoInput" placeholder="Enter task" />
      <select id="prioritySelect">
        <option value="low">Low</option>
        <option value="medium">Medium</option>
        <option value="high">High</option>
      </select>
      <button id="addBtn">Add</button>
    </div>

    <div id="todoList" class="todo-list">
      <div class="empty-state">No tasks yet</div>
    </div>

    <div class="filters">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="pending">Pending</button>
      <button class="filter-btn" data-filter="completed">Completed</button>
    </div>

    <div class="stats">
      Total: <span id="totalTasks">0</span> |
      Pending: <span id="pendingTasks">0</span> |
      Completed: <span id="completedTasks">0</span> |
      Completion Rate: <span id="completionRate">0%</span>
    </div>
  </div>

  <script>
    /* ------------------------------------------------------------------
       Grab elements
    ------------------------------------------------------------------ */
    const input           = document.getElementById('todoInput');
    const prioritySelect  = document.getElementById('prioritySelect');
    const addBtn          = document.getElementById('addBtn');
    const todoList        = document.getElementById('todoList');
    const filterBtns      = document.querySelectorAll('.filter-btn');

    const totalSpan       = document.getElementById('totalTasks');
    const pendingSpan     = document.getElementById('pendingTasks');
    const completedSpan   = document.getElementById('completedTasks');
    const rateSpan        = document.getElementById('completionRate');

    /* ------------------------------------------------------------------
       Helpers
    ------------------------------------------------------------------ */
    const showEmptyState = () => {
      if (!todoList.querySelector('.todo-item')) {
        todoList.innerHTML = '<div class="empty-state">No tasks yet</div>';
      }
    };

    const updateStats = () => {
      const allItems       = todoList.querySelectorAll('.todo-item');
      const completedItems = todoList.querySelectorAll('.todo-item.completed');

      const total    = allItems.length;
      const done     = completedItems.length;
      const pending  = total - done;
      const rate     = total ? Math.round((done / total) * 100) : 0;

      totalSpan.textContent     = total;
      pendingSpan.textContent   = pending;
      completedSpan.textContent = done;
      rateSpan.textContent      = `${rate}%`;
    };

    const applyFilter = type => {
      todoList.querySelectorAll('.todo-item').forEach(item => {
        const isDone = item.classList.contains('completed');
        const shouldHide =
          type === 'pending'   ? isDone :
          type === 'completed' ? !isDone :
          false;               // 'all'

        item.classList.toggle('hidden', shouldHide);
      });
    };

    const clearActiveFilters = () =>
      filterBtns.forEach(btn => btn.classList.remove('active'));

    /* ------------------------------------------------------------------
       Add task
    ------------------------------------------------------------------ */
    addBtn.addEventListener('click', () => {
      const taskText = input.value.trim();
      if (!taskText) { alert('Task is empty'); return; }

      // remove empty‑state, if present
      const empty = todoList.querySelector('.empty-state');
      if (empty) empty.remove();

      const priority = prioritySelect.value;
      const todoHTML = `
        <div class="todo-item">
          <input type="checkbox" class="todo-checkbox" />
          <div class="todo-text">${taskText}</div>
          <div class="priority-${priority}">${priority}</div>
          <button class="action-btn edit-btn">Edit</button>
          <button class="action-btn del-btn">Delete</button>
        </div>`;

      todoList.insertAdjacentHTML('beforeend', todoHTML);
      updateStats();
      applyFilter(document.querySelector('.filter-btn.active').dataset.filter);

      // clear & refocus
      input.value = '';
      input.focus();
    });

    /* ------------------------------------------------------------------
       Delegated events (checkbox / edit / delete)
    ------------------------------------------------------------------ */
    todoList.addEventListener('change', e => {
      if (!e.target.matches('.todo-checkbox')) return;

      const item = e.target.closest('.todo-item');
      item.classList.toggle('completed', e.target.checked);
      updateStats();
      applyFilter(document.querySelector('.filter-btn.active').dataset.filter);
    });

    todoList.addEventListener('click', e => {
      const item = e.target.closest('.todo-item');
      if (!item) return;

      /* ----- Delete ----- */
      if (e.target.matches('.del-btn')) {
        item.remove();
        showEmptyState();
        updateStats();
        return;
      }

      /* ----- Edit ----- */
      /* ----- Edit (task text + priority) ----- */
if (e.target.matches('.edit-btn')) {
  const textEl      = item.querySelector('.todo-text');
  const priorityEl  = item.querySelector('[class^="priority-"]'); // label div
  const oldPriority = priorityEl.textContent.trim().toLowerCase();

  // 1️⃣ Prompt for new task text
  const newText = prompt('Edit task:', textEl.textContent.trim());
  if (newText === null) return; // user hit “Cancel”
  if (newText.trim()) textEl.textContent = newText.trim();

  // 2️⃣ Prompt for new priority
  let newPriority = prompt('Priority (low / medium / high):', oldPriority);
  if (newPriority !== null) {
    newPriority = newPriority.trim().toLowerCase();
    if (['low', 'medium', 'high'].includes(newPriority)) {
      // Swap class and update text
      priorityEl.classList.remove(`priority-${oldPriority}`);
      priorityEl.classList.add(`priority-${newPriority}`);
      priorityEl.textContent = newPriority;
    }
  }
}

    });

    /* ------------------------------------------------------------------
       Filters
    ------------------------------------------------------------------ */
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        clearActiveFilters();
        btn.classList.add('active');
        applyFilter(btn.dataset.filter);
      });
    });

    /* initial stats */
    updateStats();
  </script>
</body>
</html>
